<script>
$(function() {
  $('.carousel').carousel(); //initialize the carousel
  
  $('#reg-form').validate({ //initialize the form validator
    errorPlacement: function(error, element) {
      $('.active .validation_error').html(error);
    },
    rules: { //TODO add validation for email address
      'patient_enrollment[login]': {
        required: true,
        email: true
      },
      'patient_enrollment[login_confirmation]' : {
        equalTo: '#patient_enrollment_login' }
    },
    messages: {
      'patient_enrollment[login]': 'Enter a valid email.',
      'patient_enrollment[login_confirmation]': 'Your Emails do not match.'
    },
    invalidHandler: function() {
      $('.validation_error').show();
    }
  })
  
  // custom validation for our password rules
  $.validator.addMethod("pwcheck", function(value) { 
    return  /[a-z]/.test(value) // has a lowercase letter
      && /[A-Z]/.test(value) // has an uppercase letter
      && /\d/.test(value) // has a digit
  });
  
  // custom validation for dropdown
  $.validator.addMethod("question_dd", function(value) {
    return $('#patient_enrollment_security_question').val() !== '';
  });
  
  $('#next-button').on('click', nextButtonClick);
  
  $('.back').on('click', backClick);
  
  $('#patient_enrollment_answer').on('keyup', answerKeyup);
  
  $('#patient_enrollment_security_question').on('change', questionChange);
});
</script>

<div class="top" />
  <form id="reg-form" method="post" novalidate="novalidate">
    <div class="carousel slide" id="registration-details">
      <div class="carousel-inner" role="listbox">
        <div class="item active" id="email">
          <div class="validation_error" style="display: none"/>
        </div>
        <div class="item" id="password">
        </div>
        <div class="item" id="security_question">
        </div>
      </div>
    </div>
    <div class="next">
      <a class="btn btn-primary" id="next-button" href="#registration-details" role="button">Next</a>
      <div class="submit" id="submit-button">
        <input class="btn btn-primary" disabled="disabled" id="create-account" name="commit" type="submit" value="Create account" />
      </div>
    </div>
    <div class="bottom">
      <span class="back" />
    </div>
  </form>